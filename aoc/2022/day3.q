d3out:{sum 1+.Q.an?raze distinct each x};
d3p1:{p:2 0N#/:x; d3out p[;0]inter'p[;1]};
d3p2:{d3out(inter/)each 3 cut x};

/
x:"\n"vs"vJrwpWtwJgWrhcsFMMfFFhFp\njqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL\nPmmdzqPrVvPwwTWBwg\nwMqvLMZHhHMvwLHjbvcjnnSBnvTQFn\nttgJtRGJQctTZtZT\nCrZsJsPPZsGzwwsLwLmpwMDw";

d3p1 x  //157
d3p2 x  //70
